# dr01d0ne â€¢ Tactical TODO â€• 2025-01-06  
_Comprehensive backlog produced after full-stack audit **2025-07-06**_

Legend:  
â€¢ P* â€“ Priority (P0 critical â†’ P3 nice-to-have)  
â€¢ â³ â€“ Effort (S â‰¤2 h, M â‰¤1 day, L â‰¤3 days, XL >3 days)  
â€¢ ğŸ”’ security â€¢ ğŸš€ perf â€¢ ğŸ“ˆ observability â€¢ ğŸ’¸ cost â€¢ ğŸ–¥ï¸ UX â€¢ ğŸ› ï¸ DX

---

## P0 (Stop-the-world ğŸš’)
| # | Task | Effort | Domain | Technical Notes |
|---|------|--------|--------|-----------------|
| 0.1 | Wire **SlowAPI Limiter** in `backend/main.py` | S | ğŸ”’ğŸ’¸ | `from slowapi import Limiter, _rate_limit_exceeded_handler`; add middleware & default limits; expose `X-RateLimit-*` headers; update tests `tests/test_rate_limit.py`. |
| 0.2 | Add **redis-cache** service to docker & Helm | S | ğŸ’¸ğŸ“ˆ | `docker-compose.yml` new service `redis-cache` (db 1, cache); update `BACKPRESSURE_REDIS_URL`; fail-fast if unreachable. |
| 0.3 | Fix **OpenTelemetry FastAPI instrumentation** | S | ğŸ“ˆ | Move `FastAPIInstrumentor.instrument_app(app, â€¦)` _after_ `app` creation (main.py line ~60); remove placeholder `None`. |
| 0.4 | Guard **Sentry `capture_exception`** | S | ğŸ”’ | Wrap calls with `if sentry_sdk.Hub.current.client:` in `backend/core/sentry_config.py` helpers and global handler. |
| 0.5 | Front-end: **migrate off localStorage tokens** | M | ğŸ”’ğŸ–¥ï¸ | Delete token save in `frontend/src/lib/auth.ts`; adjust `useAuth` â†’ rely on httpOnly cookies + `/auth/refresh`; Cypress regression. |
| 0.6 | **Redis HNSW vector index migration script** | M | ğŸš€ | New script `scripts/init_redis_vector_index.py`; `FT.CREATE IF NOT EXISTS embedding_idx PREFIX 1 graph: VECTOR HNSW â€¦`; run in Docker entrypoint. |

---

## P1 (High-impact)
| # | Task | Effort | Domain | Technical Notes |
|---|------|--------|--------|-----------------|
| 1.1 | Generate **typed OpenAPI client** for Next.js | S | ğŸ› ï¸ğŸ–¥ï¸ | `npx openapi-typescript http://backend:8000/api/v1/openapi.json -o frontend/src/lib/types/api.ts`; create React-Query hooks scaffold. |
| 1.2 | **Playwright e2e** (login â†’ chat â†’ graph) | M | ğŸ–¥ï¸ğŸ”’ | Add `/e2e/` suite; integrate in `.github/workflows/ci.yml` matrix. |
| 1.3 | Integrate **Redis budget alerts â†’ Prometheus** | S | ğŸ’¸ğŸ“ˆ | Push `external_api_budget_ratio` gauge; alert rule 90 %. |
| 1.4 | Add **provider status endpoint** `/api/v1/health/providers` | S | ğŸ“ˆ | Uses `get_all_provider_status()`; unit test. |
| 1.5 | Provision **Grafana dashboards** via JSON | M | ğŸ“ˆ | Place under `grafana/provisioning/dashboards`; import on container boot. |

---

## P2 (Medium)
| # | Task | Effort | Domain | Technical Notes |
|---|------|--------|--------|-----------------|
| 2.1 | Helm chart + Kustomize overlays | L | ğŸ› ï¸ | Chart for backend, frontend, pg, redis, neo4j; overlays prod/staging. |
| 2.2 | Replace brute-force vector search fallback with **Redis FT.SEARCH** | M | ğŸš€ | Remove numpy cosine fallback; unit test in `tests/test_vector_search.py`. |
| 2.3 | Add **SlowAPI per-IP burst + sliding window** rules | S | ğŸ”’ | `/api/v1/chat` stricter (e.g. `5/10s`); `/health` exempt. |
| 2.4 | Auto-generate **Celery queue Grafana panels** | M | ğŸ“ˆ | Extend `scripts/generate_grafana_dashboard.py`. |

---

## P3 (Quality of life / polish)
| # | Task | Effort | Domain | Technical Notes |
|---|------|--------|--------|-----------------|
| 3.1 | Next.js catch-all `[...notfound]` 404 page | S | ğŸ–¥ï¸ | Friendly UX. |
| 3.2 | Add `make dev` hot-reload combo target | S | ğŸ› ï¸ | Concurrent FastAPI `uvicorn --reload` + `next dev`. |
| 3.3 | Tailwind FOUC fix: safelist utilities | S | ğŸ–¥ï¸ | `tailwind.config.js` `safelist`. |
| 3.4 | Pre-commit hook: `mypy backend/` | S | ğŸ› ï¸ | Update `.pre-commit-config.yaml`. |
| 3.5 | Compress SVG assets | S | ğŸš€ | Run SVGO on `frontend/public`. |

---

## Dependency / Version bumps
- FastAPI â†’ `0.111 â†’ 0.116` _(test background tasks API)_
- Pydantic Settings â†’ `2.2.x`
- Redis-py â†’ `5.0.2`
- SlowAPI pinned `0.1.10`

---

## Acceptance Criteria
1. All **P0** items merged & deployed to staging, test suite green.  
2. Grafana shows API p99 latency, budget gauges, rate-limit counters.  
3. Front-end auth works with cookies only; e2e flows pass.  
4. Redis vector index created automatically; first RAG query latency â‰¤80 ms.  

_Responsible: Analyst-Droid Crew â€¢ File autogenerated 2025-01-06_
